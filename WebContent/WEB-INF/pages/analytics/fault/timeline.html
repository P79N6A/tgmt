#@layout(title="列车故障时间表")

#define content()

<script type="text/javascript" src="#(CPATH)/assets/js/echarts.min.js"></script>

<div class="admin-content">

    <div class="am-cf am-padding">
        <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">数据分析</strong> / <small>故障时间表</small></div>
    </div>

    <hr>
    
    <div class="am-g">
    	<div class="am-u-sm-1"></div>
     	<div class="am-u-sm-11">
 			<form class="am-form" action="#(CPATH)/analytics/timeline">
 				<div class="am-u-sm-5">
		   			<div class="am-input-group am-datepicker-date" data-am-datepicker="{format: 'yyyy-mm-dd'}">
		              <input  id="startdate" name="startdate"  value="#(startdate??)" type="text" class="am-form-field" placeholder="起始时间">
		              <span class="am-input-group-btn am-datepicker-add-on">
		                <button class="am-btn am-btn-default" type="button"><span class="am-icon-calendar"></span> </button>
		              </span>
		           	</div>
				</div>
				<div class="am-u-sm-5">
		           	<div class="am-input-group am-datepicker-date" data-am-datepicker="{format: 'yyyy-mm-dd'}">
		              <input  id="enddate" name="enddate"  value="#(enddate??)" type="text" class="am-form-field" placeholder="结束时间">
		              <span class="am-input-group-btn am-datepicker-add-on">
		                <button class="am-btn am-btn-default" type="button"><span class="am-icon-calendar"></span> </button>
		              </span>
		           	</div>
	           	</div>
	           	<div class="am-u-sm-2">
		           	<div class="am-input-group">
			          <span class="am-input-group-btn">
			            <input id="searchBtn" class="am-btn am-btn-default" type="submit" value="搜索">搜索</input>
			          </span>
			        </div>
		        </div>
         	</form>
 		</div>
    </div>
    <hr>
    <div class="am-g">
          
		<div id="trainErrEventGroupByNum" class="am-u-sm-12 am-u-md-12" style="width:100%;height:400px"></div>

  </div>

</div>

<script type="text/javascript">
		// 基于准备好的dom，初始化echarts实例
		var myChart = echarts.init(document.getElementById('trainErrEventGroupByNum'));
		
		var initData = #(result);
		
		var trains = [];
		var events = [];
		
		$.each(initData, function (index, item) {
			trains.push(item.train);
			events.push(item.errtimes);
		});
		
		option = {
				title: {
	                text: '列车故障发生数量统计',
	                subtext: '数据来自TGMT平台',
	                x:'center',
	                y:'top',
	                textAlign:'center'
	            },
			    tooltip : {
			        trigger: 'axis',
			        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
			            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			        }
			    },
			    legend: {
			        data: trains
			    },
			    toolbox: {
			        show : true,
			        orient: 'vertical',
			        x: 'right',
			        y: 'center',
			        feature : {
			            mark : {show: true},
			            dataView : {show: true, readOnly: false},
			            magicType : {show: true, type: ['line', 'bar', 'stack', 'tiled']},
			            restore : {show: true},
			            saveAsImage : {show: true}
			        }
			    },
			    calculable : true,
			    xAxis : [
			        {
			            type : 'category',
			            axisLine: {onZero: false},
			            name : '列车号',
			            data : trains
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value',
			            name : '故障数'
			        }
			    ],
			    series : [
			        {
			            name: '故障数',
			            type: 'bar',
			            data: events
			        }
			    ]
			};
			                    		
		
		myChart.setOption(option);
		
	</script>

#end
