#@layout(title="首页")

#define content()

<script type="text/javascript" src="#(CPATH)/assets/js/echarts.min.js"></script>

<div class="admin-content">

    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">首页</strong> / <small>实时信息</small></div>
    </div>

    <ul class="am-avg-sm-1 am-avg-md-4 am-margin am-padding am-text-center admin-content-list ">
      <li>
      
      <a href="#" class="am-text-success"><span class="am-icon-btn am-icon-train"></span><br/>今天已入库日志列车计数<br/>#(logTrainCounts)</a>
       <!-- 
       <div id="todayLogTrainCounts" style="height:280px"></div>
       <script type="text/javascript">
			var todayLogTrainCntsReport = echarts.init(document.getElementById('todayLogTrainCounts'));
			var logTrainCounts = #(logTrainCounts??)
			logTrainCountsOption = {
					title : {
						text: '今天已入库日志列车计数',
				        x:'center',
				        y:'top'
					},
				    tooltip : {
				        formatter: "{a} <br/>{b} : {c}"
				    },
				    
				    series: [
		                {
		                    name: '列车数',
		                    type: 'gauge',
		                    max:20,
		                    detail: {formatter:'{value}列'},
		                    data: [{value: logTrainCounts, name: '列车数'}]
		                }
		            ]
				    
				};
			todayLogTrainCntsReport.setOption(logTrainCountsOption);
		</script> 
      	-->
      
      </li>
      <li><a href="#" class="am-text-secondary"><span class="am-icon-btn am-icon-calendar-times-o"></span><br/>今天已入库日志计数<br/>#(logErrCounts)</a></li>
      <li><a href="#(CPATH)/mps/status" class="am-text-warning"><span class="am-icon-btn am-icon-wifi"></span><br/>在线MPS<br/>#(mpsStatusMap.get("online"))</a></li>
      <li><a href="#(CPATH)/mps/status" class="am-text-danger"><span class="am-icon-btn am-icon-plug"></span><br/>离线MPS<br/>#(mpsStatusMap.get("offline"))</a></li>

    </ul>

    <div class="am-g">
      <div class="am-u-sm-12">
      	<div class="am-panel am-panel-default">
	      	<div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-catalog-counts'}">列车故障组件种类统计<span class="am-icon-chevron-down am-fr" ></span></div>
	          	<div class="am-panel-bd am-collapse am-in" id="collapse-panel-catalog-counts">
			        <table class="am-table am-table-bd am-table-striped admin-content-table">
			          <thead>
			          <tr>
			            <th>列车号</th><th>计算模块种类数</th><th>车载单元种类数</th><th>子模块种类数</th><th>元素种类数</th><th>错误提示种类数</th>
			          </tr>
			          </thead>
			          <tbody>
			         
			          	<!--  <tr>
			          	<td>1</td><td>John Clark</td><td><a href="#">Business management</a></td> <td><span class="am-badge am-badge-success">+20</span></td>
			            <td>
			              <div class="am-dropdown" data-am-dropdown>
			                <button class="am-btn am-btn-default am-btn-xs am-dropdown-toggle" data-am-dropdown-toggle><span class="am-icon-cog"></span> <span class="am-icon-caret-down"></span></button>
			                <ul class="am-dropdown-content">
			                  <li><a href="#">1. 编辑</a></li>
			                  <li><a href="#">2. 下载</a></li>
			                  <li><a href="#">3. 删除</a></li>
			                </ul>
			              </div>
			            </td>
			            </tr> -->
			          
			          #for(x:trainErrCatalog)
			          	<tr>
			          		<td>#("T0"+x.train)</td>
			          		<td>#(x.cpm_cnts)</td>
			          		<td>#(x.obcu_cnts)</td>
			          		<td>#(x.item_cnts)</td>
			          		<td>#(x.element_cnts)</td>
			          		<td>#(x.errortype_cnts)</td>
			          	</tr>
			          #end
			          </tbody>
			        </table>
	        	</div>
	        </div>
        </div>
    </div>

    <div class="am-g">
      <div class="am-u-md-6">
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-grp-train-num'}">列车故障概况(按列车号统计)<span class="am-icon-chevron-down am-fr" ></span></div>
          <div class="am-panel-bd am-collapse am-in" id="collapse-panel-grp-train-num">
            
            
           <div id="trainErrEventGroupByTrainNum" style="height:300px"></div>
           <script type="text/javascript">
				var byTrainNumReport = echarts.init(document.getElementById('trainErrEventGroupByTrainNum'));
				
				var byTrainNumErrs = #(trainNumErrs??)
				
				var byTrainNumLegendData = [];
				var byTrainNumData = [];
				
				$.each(byTrainNumErrs, function(index, item){
					var trainName = "T0" + item.train;
					var row = {value: item.errtimes, name: trainName};
					byTrainNumData.push(row);
					byTrainNumLegendData.push(trainName);
				});
				
				byTrainNumOption = {
					    tooltip : {
					        trigger: 'item',
					        formatter: "{a} <br/>{b} : {c} ({d}%)"
					    },
					    legend: {
					        bottom: 'left',
					        data: byTrainNumLegendData
					    },
					    toolbox: {
					        show : true,
					        orient: 'vertical',
					        x: 'right',
					        y: 'center',
					        feature : {
					            mark : {show: true},
					            dataView : {show: true, readOnly: false},
					            saveAsImage : {show: true}
					        }
					    },
					    series : [
					        {
					            name: '列车号',
					            type: 'pie',
					            radius : '55%',
					            data: byTrainNumData,
					            itemStyle: {
					                emphasis: {
					                    shadowBlur: 10,
					                    shadowOffsetX: 0,
					                    shadowColor: 'rgba(0, 0, 0, 0.5)'
					                }
					            }
					        }
					    ]
					};
				
					
				byTrainNumReport.setOption(byTrainNumOption);
			</script> 
			
			 
          </div>
        </div>
        
        #if(null!=todayTrainErrs && todayTrainErrs.size()>0)
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-today-train-errs'}">今天故障数排名前五的列车<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-today-train-errs" class="am-in">
            <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
              <tbody>
              <tr>
                <th class="am-text-center">#</th>
                <th>列车号</th>
                <th>故障数</th>
              </tr>
              #for(x:todayTrainErrs)
              <tr>
                <td class="am-text-center">#(for.index+1)</td>
                <td>#("T0" + x.train)</td>
                <td>
					#if(for.index==0)
	                <span class="am-badge am-badge-danger">#(x.errtimes)</span>
	                #else if(for.index==1)
	                <span class="am-badge am-badge-warning">#(x.errtimes)</span>
	                #else if(for.index==2)
	                <span class="am-badge am-badge-success">#(x.errtimes)</span>
	                #else if(for.index==3)
	                <span class="am-badge am-badge-secondary">#(x.errtimes)</span>
	                #else if(for.index==4)
	                <span class="am-badge">#(x.errtimes)</span>                
	                #end
				</td>
              </tr>
              #end
              </tbody>
            </table>
          </div>
        </div>
        #end
        
        #if(null!=currentWeekTrainErrs && currentWeekTrainErrs.size()>0)
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-currentweek-train-errs'}">本周故障数排名前五的列车<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-currentweek-train-errs" class="am-in">
            <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
              <tbody>
              <tr>
                <th class="am-text-center">#</th>
                <th>列车号</th>
                <th>故障数</th>
              </tr>
              #for(x:currentWeekTrainErrs)
              <tr>
                <td class="am-text-center">#(for.index+1)</td>
                <td>#("T0" + x.train)</td>
                <td>
					#if(for.index==0)
	                <span class="am-badge am-badge-danger">#(x.errtimes)</span>
	                #else if(for.index==1)
	                <span class="am-badge am-badge-warning">#(x.errtimes)</span>
	                #else if(for.index==2)
	                <span class="am-badge am-badge-success">#(x.errtimes)</span>
	                #else if(for.index==3)
	                <span class="am-badge am-badge-secondary">#(x.errtimes)</span>
	                #else if(for.index==4)
	                <span class="am-badge">#(x.errtimes)</span>                
	                #end
				</td>
              </tr>
              #end
              </tbody>
            </table>
          </div>
        </div>
        #end
        
        #if(null!=lastWeekTrainErrs && lastWeekTrainErrs.size()>0)
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-lastweek-train-errs'}">上周故障数排名前五的列车<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-lastweek-train-errs" class="am-in">
            <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
              <tbody>
              <tr>
                <th class="am-text-center">#</th>
                <th>列车号</th>
                <th>故障数</th>
              </tr>
              #for(x:lastWeekTrainErrs)
              <tr>
                <td class="am-text-center">#(for.index+1)</td>
                <td>#("T0" + x.train)</td>
                <td>	
                	#if(for.index==0)
	                <span class="am-badge am-badge-danger">#(x.errtimes)</span>
	                #else if(for.index==1)
	                <span class="am-badge am-badge-warning">#(x.errtimes)</span>
	                #else if(for.index==2)
	                <span class="am-badge am-badge-success">#(x.errtimes)</span>
	                #else if(for.index==3)
	                <span class="am-badge am-badge-secondary">#(x.errtimes)</span>
	                #else if(for.index==4)
	                <span class="am-badge">#(x.errtimes)</span>                
	                #end
	             </td>
              </tr>
              #end
              </tbody>
            </table>
          </div>
        </div>
        #end
        
        #if(null!=currentMonthTrainErrs && currentMonthTrainErrs.size()>0)
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-currentmonth-train-errs'}">本月故障数排名前五的列车<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-currentmonth-train-errs" class="am-in">
            <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
              <tbody>
              <tr>
                <th class="am-text-center">#</th>
                <th>列车号</th>
                <th>故障数</th>
              </tr>
              #for(x:currentMonthTrainErrs)
              <tr>
                <td class="am-text-center">#(for.index+1)</td>
                <td>#("T0" + x.train)</td>
                <td>
					#if(for.index==0)
	                <span class="am-badge am-badge-danger">#(x.errtimes)</span>
	                #else if(for.index==1)
	                <span class="am-badge am-badge-warning">#(x.errtimes)</span>
	                #else if(for.index==2)
	                <span class="am-badge am-badge-success">#(x.errtimes)</span>
	                #else if(for.index==3)
	                <span class="am-badge am-badge-secondary">#(x.errtimes)</span>
	                #else if(for.index==4)
	                <span class="am-badge">#(x.errtimes)</span>                
	                #end
				</td>
              </tr>
              #end
              </tbody>
            </table>
          </div>
        </div>
        #end
        
        #if(null!=lastMonthTrainErrs && lastMonthTrainErrs.size()>0)
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-lastmonth-train-errs'}">上月故障数排名前五的列车<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-lastmonth-train-errs" class="am-in">
            <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
              <tbody>
              <tr>
                <th class="am-text-center">#</th>
                <th>列车号</th>
                <th>故障数</th>
              </tr>
              #for(x:lastMonthTrainErrs)
              <tr>
                <td class="am-text-center">#(for.index+1)</td>
                <td>#("T0" + x.train)</td>
                <td>
                #if(for.index==0)
                <span class="am-badge am-badge-danger">#(x.errtimes)</span>
                #else if(for.index==1)
                <span class="am-badge am-badge-warning">#(x.errtimes)</span>
                #else if(for.index==2)
                <span class="am-badge am-badge-success">#(x.errtimes)</span>
                #else if(for.index==3)
                <span class="am-badge am-badge-secondary">#(x.errtimes)</span>
                #else if(for.index==4)
                <span class="am-badge">#(x.errtimes)</span>                
                #end
                </td>
              </tr>
              #end
              </tbody>
            </table>
          </div>
        </div>
        #end
        
      </div>

      <div class="am-u-md-6">
        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-4'}">任务 task<span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-4" class="am-panel-bd am-collapse am-in">
            <ul class="am-list admin-content-task">
              <li>
                <div class="admin-task-meta"> Posted on 25/1/2120 by John Clark</div>
                <div class="admin-task-bd">
                  The starting place for exploring business management; helping new managers get started and experienced managers get better.
                </div>
                <div class="am-cf">
                  <div class="am-btn-toolbar am-fl">
                    <div class="am-btn-group am-btn-group-xs">
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-check"></span></button>
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-pencil"></span></button>
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-times"></span></button>
                    </div>
                  </div>
                  <div class="am-fr">
                    <button type="button" class="am-btn am-btn-default am-btn-xs">删除</button>
                  </div>
                </div>
              </li>
              <li>
                <div class="admin-task-meta"> Posted on 25/1/2120 by 呵呵呵</div>
                <div class="admin-task-bd">
                  基兰和狗熊出现在不同阵营时。基兰会获得BUFF，“装甲熊憎恨者”。狗熊会获得BUFF，“时光老人憎恨者”。
                </div>
                <div class="am-cf">
                  <div class="am-btn-toolbar am-fl">
                    <div class="am-btn-group am-btn-group-xs">
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-check"></span></button>
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-pencil"></span></button>
                      <button type="button" class="am-btn am-btn-default"><span class="am-icon-times"></span></button>
                    </div>
                  </div>
                  <div class="am-fr">
                    <button type="button" class="am-btn am-btn-default am-btn-xs">删除</button>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-3'}">最近留言<span class="am-icon-chevron-down am-fr" ></span></div>
          <div class="am-panel-bd am-collapse am-in am-cf" id="collapse-panel-3">
            <ul class="am-comments-list admin-content-comment">
              <li class="am-comment">
                <a href="#"><img src="http://s.amazeui.org/media/i/demos/bw-2014-06-19.jpg?imageView/1/w/96/h/96" alt="" class="am-comment-avatar" width="48" height="48"></a>
                <div class="am-comment-main">
                  <header class="am-comment-hd">
                    <div class="am-comment-meta"><a href="#" class="am-comment-author">某人</a> 评论于 <time>2014-7-12 15:30</time></div>
                  </header>
                  <div class="am-comment-bd"><p>遵循 “移动优先（Mobile First）”、“渐进增强（Progressive enhancement）”的理念，可先从移动设备开始开发网站，逐步在扩展的更大屏幕的设备上，专注于最重要的内容和交互，很好。</p>
                  </div>
                </div>
              </li>

              <li class="am-comment">
                <a href="#"><img src="http://s.amazeui.org/media/i/demos/bw-2014-06-19.jpg?imageView/1/w/96/h/96" alt="" class="am-comment-avatar" width="48" height="48"></a>
                <div class="am-comment-main">
                  <header class="am-comment-hd">
                    <div class="am-comment-meta"><a href="#" class="am-comment-author">某人</a> 评论于 <time>2014-7-12 15:30</time></div>
                  </header>
                  <div class="am-comment-bd"><p>有效减少为兼容旧浏览器的臃肿代码；基于 CSS3 的交互效果，平滑、高效。AMUI专注于现代浏览器（支持HTML5），不再为过时的浏览器耗费资源，为更有价值的用户提高更好的体验。</p>
                  </div>
                </div>
              </li>

            </ul>
            <ul class="am-pagination am-fr admin-content-pagination">
              <li class="am-disabled"><a href="#">&laquo;</a></li>
              <li class="am-active"><a href="#">1</a></li>
              <li><a href="#">2</a></li>
              <li><a href="#">3</a></li>
              <li><a href="#">4</a></li>
              <li><a href="#">5</a></li>
              <li><a href="#">&raquo;</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

#end


